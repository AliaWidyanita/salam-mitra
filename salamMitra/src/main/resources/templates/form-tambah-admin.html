<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://thymeleaf.org">

<head>
  <object th:insert="~{fragments/common :: fragment}" th:remove="tag"></object>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" />
</head>

<body>
  <div th:replace="~{fragments/navbar :: header}"></div>
  <div class="container">
    <div class="container-fluid"
      style="padding-bottom: 5%; padding-top: 15%; display: flex; align-items: center; justify-content: center;">
      <div class="container" data-aos="fade-up">
        <div class="row d-flex justify-content-center">
          <h2 class="text-center m-4">Tambah Admin</h2>
          <div class="container">
            <form class="row g-3" th:action="@{/pengguna-tambah-admin}" th:object="${adminDTO}" method="POST">
              <div class="col-md-6">
                <label for="validationDefault01" class="form-label">Username*</label>
                <input type="text" class="form-control" th:field="*{username}" required />
              </div>
              <div class="col-md-6">
                <label for="validationDefault01" class="form-label">Email*</label>
                <input type="text" class="form-control" id="emailInput" th:field="*{email}" required />
                <div id="email-error" class="text-danger" style="display: none;">Masukkan alamat email yang valid</div>
              </div>
              <div class="col-md-6">
                <label for="validationDefault01" class="form-label">Password*</label>
                <div class="input-group">
                  <input type="password" class="form-control" name="password" id="password" th:field="*{password}" required />
                  <span class="input-group-text" id="inputGroupPrepend2"><i class="bi bi-eye-slash"
                      id="togglePassword"></i></span>
                </div>
                <div id="password-error" class="text-danger" style="display: none;"></div>
              </div>
              <div class="col-md-6">
                <label for="validationDefault01" class="form-label">Name Lengkap*</label>
                <input type="text" class="form-control" th:field="*{fullName}" required />
              </div>
              <div class="col-md-6">
                <label for="validationDefault01" class="form-label">Alamat*</label>
                <input type="text" class="form-control" th:field="*{address}" required />
              </div>
              <div class="col-md-6">
                <label for="validationDefault04" class="form-label">Jenis Kelamin*</label>
                <br>
                <select class="form-control form-select" style="width: 100%" th:field="*{gender}" required>
                  <option selected disabled value="">--Pilih Jenis Kelamin--</option>
                  <option value="Laki-Laki">Pria</option>
                  <option value="Perempuan">Wanita</option>
                </select>
              </div>
              <div class="col-md-6">
                <label for="validationDefault02" class="form-label">Kontak*</label>
                <input type="number" class="form-control" style="width: 100%" id="contactInput" th:field="*{contact}" required />
                <div id="contactError" class="text-danger" style="display: none;"></div>
              </div>
              <div class="col-md-6">
                <label for="validationDefault04" class="form-label">Admin Role*</label>
                <br>
                <select class="form-control form-select" id="validationDefault04" style="width: 100%" name=adminRole
                  required>
                  <option selected disabled value="">--Pilih Role Admin--</option>
                  <option value="PROGRAM">Program</option>
                  <option value="FINANCE">Finance</option>
                </select>
              </div>
              <div class="text-center m-4">
                <a class="btn btn-danger " style="background-color: #e74454" href="/pengguna">Batal</a>
                <button class="btn btn-primary" style="background-color: #6793F6; color: #fff"
                  type="submit">Simpan</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const contactInput = document.getElementById('contactInput');
    const contactError = document.getElementById('contactError');

    contactInput.addEventListener('input', () => {
        const contact = contactInput.value.trim(); // Menghapus spasi di awal dan akhir
        const startsWith08 = /^08/.test(contact);
        const isValidLength = contact.length >= 10 && contact.length <= 13;

        if (!startsWith08 && contact.length > 0) {
            // Jika nomor tidak diawali dengan "08" dan tidak kosong
            contactError.style.display = 'block';
            contactError.textContent = 'Nomor telepon harus diawali dengan "08".';
        } else if (!isValidLength && startsWith08) {
            // Jika nomor diawali dengan "08" tetapi tidak memenuhi panjang yang valid
            contactError.style.display = 'block';
            contactError.textContent = 'Nomor telepon harus terdiri dari 10-13 digit.';
        } else {
            // Jika nomor telepon memenuhi kriteria
            contactError.style.display = 'none';
            contactError.textContent = '';
        }
    });
  </script>

  <script>
    const emailInput = document.getElementById('emailInput');
    const emailError = document.getElementById('email-error');

    emailInput.addEventListener('input', () => {
      const email = emailInput.value;
      const isValidEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);

      if (!isValidEmail) {
        emailError.style.display = 'block';
      } else {
        emailError.style.display = 'none';
      }
    });
  </script>

  <script>
    const passwordInput = document.getElementById('password');
    const passwordError = document.getElementById('password-error');

    passwordInput.addEventListener('input', () => {
      const password = passwordInput.value;
      if (password.length < 8 || password.length > 20) {
        passwordError.style.display = 'block';
        passwordError.textContent = 'Password harus terdiri dari 8-20 karakter.';
      } else if (!/[a-zA-Z]/.test(password) || !/\d/.test(password)) {
        passwordError.style.display = 'block';
        passwordError.textContent = 'Password harus mengandung huruf dan angka.';
      } else if (/\s/.test(password) || /[^\w\s]/.test(password)) {
        passwordError.style.display = 'block';
        passwordError.textContent = 'Password tidak boleh mengandung spasi, karakter khusus, atau emoji.';
      } else {
        passwordError.style.display = 'none';
      }
    });
  </script>

  <script>
    const togglePassword = document.querySelector("#togglePassword");
    const password = document.querySelector("#password");

    togglePassword.addEventListener("click", function () {
      // toggle the type attribute
      const type = password.getAttribute("type") === "password" ? "text" : "password";
      password.setAttribute("type", type);

      // toggle the icon
      this.classList.toggle("bi-eye");
    });

    $(document).ready(function () {
      $('#dataTable').DataTable({
        "ordering": false, // Menonaktifkan sorting
        "searching": false // Menonaktifkan fitur pencarian
      });
    });

    function validatePhoneNumber(input) {
      // Hapus karakter selain angka
      var phoneNumber = input.value.replace(/\D/g, '');

      // Pastikan awalan nomor telepon adalah "08"
      if (!phoneNumber.startsWith('08')) {
        input.setCustomValidity('Nomor telepon tidak valid harus diawali 08');
      } else {
        // Pastikan panjang nomor telepon antara 11 dan 13 digit
        if (phoneNumber.length < 11 || phoneNumber.length > 13) {
          input.setCustomValidity('Nomor telepon tidak valid harus terdiri dari 10-13 digit');
        } else {
          input.setCustomValidity('');
        }
      }
    }
    input.value = '0' + phoneNumber;
  </script>

  <!-- Sertakan referensi ke jQuery di sini -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <!-- Sertakan referensi ke DataTables JavaScript di sini -->
  <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js"></script>
  <!-- jquery -->
  <script src="assets/js/jquery-1.11.3.min.js"></script>
  <!-- bootstrap -->
  <script src="assets/bootstrap/js/bootstrap.min.js"></script>
  <!-- count down -->
  <script src="assets/js/jquery.countdown.js"></script>
  <!-- isotope -->
  <script src="assets/js/jquery.isotope-3.0.6.min.js"></script>
  <!-- waypoints -->
  <script src="assets/js/waypoints.js"></script>
  <!-- owl carousel -->
  <script src="assets/js/owl.carousel.min.js"></script>
  <!-- magnific popup -->
  <script src="assets/js/jquery.magnific-popup.min.js"></script>
  <!-- mean menu -->
  <script src="assets/js/jquery.meanmenu.min.js"></script>
  <!-- sticker js -->
  <script src="assets/js/sticker.js"></script>
  <!-- main js -->
  <script src="assets/js/main.js"></script>
</body>

</html>